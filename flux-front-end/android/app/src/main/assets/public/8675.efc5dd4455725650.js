"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8675],{8675:(T,x,c)=>{c.r(x),c.d(x,{ConfigFluxPageModule:()=>O});var C=c(177),a=c(4341),u=c(9465),b=c(897),p=c(467),v=c(8866),e=c(3953),f=c(1626),m=c(5312);let F=(()=>{var t;class s{constructor(o){this.http=o,this.apiUrl=m.c.baseApiUrl}listarUsuario(o,n){const r=(new f.Lr).set("Authorization",`Bearer ${n}`);return this.http.get(`${this.apiUrl}flux/buscar-usuario/${o}?token=${n}`,{headers:r})}}return(t=s).\u0275fac=function(o){return new(o||t)(e.KVO(f.Qq))},t.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),s})();var k=c(8810),h=c(4796);let y=(()=>{var t;class s{constructor(o,n){this.http=o,this.authService=n,this.apiUrl=m.c.baseApiUrl}atualizarInformacoesUsuario(o,n,r){const i=this.authService.getToken();return this.http.post(`${this.apiUrl}flux/refresh-token?token=${i}`,{}).toPromise().then(d=>{if(d&&d.token)return this.http.post(`${this.apiUrl}flux/refresh-token?token=${d.token}`,{}),localStorage.clear(),localStorage.setItem("token",d.token),this.http.patch(`${this.apiUrl}flux/atualizar-usuario/${n}?token=${d.token}`,o).toPromise().then(g=>(this.authService.login(g),g));throw new Error("Token n\xe3o encontrado na resposta da atualiza\xe7\xe3o de usu\xe1rio.")}).catch(this.handleError)}handleError(o){return console.error("Erro no servi\xe7o:",o),(0,k.$)(o)}}return(t=s).\u0275fac=function(o){return new(o||t)(e.KVO(f.Qq),e.KVO(h.u))},t.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),s})();var P=c(9437);let M=(()=>{var t;class s{constructor(o,n){this.http=o,this.authService=n,this.apiUrl=m.c.baseApiUrl}deletarUsuario(o,n){const r=this.authService.getToken();return this.http.delete(`${this.apiUrl}flux/excluir-usuario/${o}?token=${r}`,o).pipe((0,P.W)(this.handleError))}handleError(o){return console.error("Erro no servi\xe7o:",o),(0,k.$)(o)}}return(t=s).\u0275fac=function(o){return new(o||t)(e.KVO(f.Qq),e.KVO(h.u))},t.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),s})();var S=c(6554),E=c(2872);function _(t,s){if(1&t){const l=e.RV6();e.j41(0,"div",22)(1,"form",23),e.bIt("ngSubmit",function(){e.eBV(l);const n=e.XpG();return e.Njj(n.atualizarInformacoes())}),e.nrm(2,"input",24)(3,"input",25)(4,"input",26)(5,"input",27),e.j41(6,"button",28),e.bIt("click",function(){e.eBV(l);const n=e.XpG();return e.Njj(n.showLoading())}),e.EFF(7,"Salvar Informa\xe7\xf5es Pessoais"),e.k0s()()()}if(2&t){const l=s.$implicit,o=e.XpG();e.R7$(),e.Y8G("formGroup",o.editarInformacoesForm),e.R7$(),e.FS9("value",l.id)}}function I(t,s){if(1&t&&(e.j41(0,"form"),e.nrm(1,"input",24),e.j41(2,"label",29),e.EFF(3,"Senha:"),e.k0s(),e.nrm(4,"input",30),e.j41(5,"label",29),e.EFF(6,"Confirmar Senha:"),e.k0s(),e.nrm(7,"input",30),e.j41(8,"button",11),e.EFF(9,"Salvar Informa\xe7\xf5es de Conta"),e.k0s()()),2&t){const l=s.$implicit;e.R7$(),e.FS9("value",l.id)}}const U=[{path:"",component:(()=>{var t;class s{constructor(o,n,r,i,d,g,w,R){this.tran=o,this.formBuilder=n,this.updateAccountService=r,this.authService=i,this.deleteUser=d,this.spinner=g,this.loadingCtrl=w,this.navCtrl=R,this.informations=[],this.user={nome:"",email:"",cpf:"",password:"",securityQuestion:"",securityAnswer:"",emailPref:!1,smsPref:!1,idNumber:"",twoFactorStatus:"",securitySettings:""},this.alertButtonBack=[{text:"Cancelar",role:"cancel",cssClass:"alert-button-cancel",handler:()=>{}},{text:"Sair",role:"confirm",cssClass:"alert-button-confirm",handler:()=>{this.authService.signOutExternal(),this.navCtrl.navigateRoot("/login",{replaceUrl:!0})}}],this.alertButtonDeleteAccount=[{text:"Cancelar",role:"cancel",cssClass:"alert-button-cancel",handler:()=>{this.navCtrl.navigateRoot("tabs/config-flux",{replaceUrl:!0})}},{text:"Excluir conta",role:"confirm",cssClass:"alert-button-confirm",handler:()=>{this.deleteUserById()}}]}ngOnInit(){this.decodeToken();const o=localStorage.getItem("token");o&&this.id?this.tran.listarUsuario(this.id,o).subscribe(n=>{n?(this.editarInformacoesForm.patchValue({nome:n.nome,email:n.email,cpf:n.cpf,senha:n.senha}),this.informations=[{id:n.id_usuario,nome:n.nome,email:n.email,cpf:n.cpf}]):console.error("Dados inv\xe1lidos retornados da API:",n)},n=>{console.error("Erro ao buscar dados da API",n)}):console.error("Token n\xe3o encontrado."),this.editarInformacoesForm=this.formBuilder.group({nome:["",[a.k0.required,a.k0.minLength(3)]],cpf:["",[a.k0.required,a.k0.pattern(/^\d{11}$/)]],email:["",[a.k0.required,a.k0.email]],senha:["",[a.k0.required,a.k0.minLength(6)]],confirmPassword:["",a.k0.required]})}decodeToken(){const o=localStorage.getItem("token");if(o)try{const n=(0,v.s)(o);return n&&n.id?(this.id=n.id,n.id):(console.error("Payload do token inv\xe1lido:",n),n.id)}catch(n){console.error("Erro ao decodificar o token:",n)}else console.error("Token n\xe3o encontrado.");return null}toggleSection(o){var n;const r=document.getElementById(o),i=null==r||null===(n=r.previousElementSibling)||void 0===n?void 0:n.querySelector(".arrow");r&&(r.classList.contains("show")?(r.classList.remove("show"),i&&(i.style.transform="rotate(0deg)")):(r.classList.add("show"),i&&(i.style.transform="rotate(180deg)")))}atualizarInformacoes(){var o=this;return(0,p.A)(function*(){const n=o.editarInformacoesForm.value,r=localStorage.getItem("token");if(r&&o.id)try{(yield o.updateAccountService.atualizarInformacoesUsuario(n,o.id,r))&&o.navCtrl.navigateRoot("tabs/home",{replaceUrl:!0}).then(()=>{window.location.reload()})}catch(i){console.error("Erro ao atualizar usu\xe1rio:",i)}})()}deleteUserById(){var o=this;return(0,p.A)(function*(){const n=o.decodeToken(),r=localStorage.getItem("token");if(n&&r)try{yield o.deleteUser.deletarUsuario(n,r).toPromise(),o.authService.deleteToken(),o.navCtrl.navigateRoot("/cadastro-usuario",{replaceUrl:!0})}catch(i){console.error("Erro ao excluir usu\xe1rio",i)}else console.error("ID do usu\xe1rio ou token n\xe3o encontrado")})()}showLoading(){var o=this;return(0,p.A)(function*(){(yield o.loadingCtrl.create({message:"Atualizando informa\xe7\xf5es",duration:1e3})).present()})()}}return(t=s).\u0275fac=function(o){return new(o||t)(e.rXU(F),e.rXU(a.ok),e.rXU(y),e.rXU(h.u),e.rXU(M),e.rXU(S.ex),e.rXU(u.Xi),e.rXU(E.q9))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-config-flux"]],decls:54,vars:8,consts:[[1,"container"],[1,"section"],["name","chevron-down",1,"arrow",3,"click"],["id","informacoes-pessoais","class","collapsible",4,"ngFor","ngForOf"],["id","informacoes-conta",1,"collapsible"],[4,"ngFor","ngForOf"],["id","informacoes-seguranca",1,"collapsible"],["for","security-question"],["type","text","id","security-question","name","security-question",1,"input-style",3,"ngModelChange","ngModel"],["for","security-answer"],["type","text","id","security-answer","name","security-answer",1,"input-style",3,"ngModelChange","ngModel"],["type","submit"],["id","preferencias-comunicacao",1,"collapsible"],["id","email-pref","name","email-pref",1,"input-style",3,"ngModelChange","ngModel"],["id","sms-pref","name","sms-pref",1,"input-style",3,"ngModelChange","ngModel"],["id","sair-excluir",1,"collapsible"],[1,"list-btns"],[1,"list-btns","list-itens"],["id","present-alert-logout",1,"btn-s"],["cssClass","my-custom-class","trigger","present-alert-logout","header","Voc\xea realmente deseja sair da sua conta?",3,"buttons"],["id","present-alert-delete",1,"btn-s"],["cssClass","my-custom-class","trigger","present-alert-delete","header","Voc\xea realmente deseja excluir sua conta?",3,"buttons"],["id","informacoes-pessoais",1,"collapsible"],[3,"ngSubmit","formGroup"],["type","hidden",3,"value"],["type","text","id","nome","name","nome","formControlName","nome",1,"input-style"],["type","email","id","email","name","email","formControlName","email",1,"input-style"],["type","text","id","cpf","name","cpf","formControlName","cpf",1,"input-style"],["type","submit",3,"click"],["for","password"],["type","password","id","password","name","password",1,"input-style"]],template:function(o,n){1&o&&(e.j41(0,"ion-content")(1,"div",0)(2,"h1"),e.EFF(3,"Editar Perfil"),e.k0s(),e.j41(4,"div",1)(5,"h2"),e.EFF(6," Informa\xe7\xf5es Pessoais "),e.j41(7,"ion-icon",2),e.bIt("click",function(){return n.toggleSection("informacoes-pessoais")}),e.k0s()(),e.DNE(8,_,8,2,"div",3),e.k0s(),e.j41(9,"div",1)(10,"h2"),e.EFF(11," Informa\xe7\xf5es de Conta "),e.j41(12,"ion-icon",2),e.bIt("click",function(){return n.toggleSection("informacoes-conta")}),e.k0s()(),e.j41(13,"div",4),e.DNE(14,I,10,1,"form",5),e.k0s()(),e.j41(15,"div",1)(16,"h2"),e.EFF(17," Informa\xe7\xf5es de Seguran\xe7a "),e.j41(18,"ion-icon",2),e.bIt("click",function(){return n.toggleSection("informacoes-seguranca")}),e.k0s()(),e.j41(19,"div",6)(20,"form")(21,"label",7),e.EFF(22,"Pergunta de Seguran\xe7a:"),e.k0s(),e.j41(23,"input",8),e.mxI("ngModelChange",function(i){return e.DH7(n.user.securityQuestion,i)||(n.user.securityQuestion=i),i}),e.k0s(),e.j41(24,"label",9),e.EFF(25,"Resposta:"),e.k0s(),e.j41(26,"input",10),e.mxI("ngModelChange",function(i){return e.DH7(n.user.securityAnswer,i)||(n.user.securityAnswer=i),i}),e.k0s(),e.j41(27,"button",11),e.EFF(28,"Salvar Informa\xe7\xf5es de Seguran\xe7a"),e.k0s()()()(),e.j41(29,"div",1)(30,"h2"),e.EFF(31," Prefer\xeancias de Comunica\xe7\xe3o "),e.j41(32,"ion-icon",2),e.bIt("click",function(){return n.toggleSection("preferencias-comunicacao")}),e.k0s()(),e.j41(33,"div",12)(34,"form")(35,"ion-checkbox",13),e.mxI("ngModelChange",function(i){return e.DH7(n.user.emailPref,i)||(n.user.emailPref=i),i}),e.EFF(36,"Receber Emails:"),e.k0s(),e.nrm(37,"br"),e.j41(38,"ion-checkbox",14),e.mxI("ngModelChange",function(i){return e.DH7(n.user.smsPref,i)||(n.user.smsPref=i),i}),e.EFF(39,"Receber SMS:"),e.k0s()()()(),e.j41(40,"div",1)(41,"h2"),e.EFF(42," Sair ou Excluir conta "),e.j41(43,"ion-icon",2),e.bIt("click",function(){return n.toggleSection("sair-excluir")}),e.k0s()(),e.j41(44,"div",15)(45,"ul",16)(46,"li",17)(47,"ion-button",18),e.EFF(48,"Sair"),e.k0s(),e.nrm(49,"ion-alert",19),e.k0s(),e.j41(50,"li",17)(51,"ion-button",20),e.EFF(52,"Excluir conta"),e.k0s(),e.nrm(53,"ion-alert",21),e.k0s()()()()()()),2&o&&(e.R7$(8),e.Y8G("ngForOf",n.informations),e.R7$(6),e.Y8G("ngForOf",n.informations),e.R7$(9),e.R50("ngModel",n.user.securityQuestion),e.R7$(3),e.R50("ngModel",n.user.securityAnswer),e.R7$(9),e.R50("ngModel",n.user.emailPref),e.R7$(3),e.R50("ngModel",n.user.smsPref),e.R7$(11),e.Y8G("buttons",n.alertButtonBack),e.R7$(4),e.Y8G("buttons",n.alertButtonDeleteAccount))},dependencies:[C.Sq,a.qT,a.me,a.BC,a.cb,a.vS,a.cV,u.Zy,u.Jm,u.eY,u.W9,u.iq,u.hB,a.j4,a.JD],styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;padding:20px;box-shadow:0 0 10px #0000001a;border-radius:10px;max-width:600px;width:100%}h1[_ngcontent-%COMP%]{font-family:Inter,sans-serif;font-size:30px;color:#fff;text-align:center;margin-bottom:20px}.section[_ngcontent-%COMP%]{margin:20px 0}.section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-size:20px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;color:#fff;position:relative}.arrow[_ngcontent-%COMP%]{cursor:pointer;transition:transform .3s ease;padding-left:4px}.collapsible[_ngcontent-%COMP%]{display:none;margin-top:10px}.collapsible.show[_ngcontent-%COMP%]{display:block}form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.input-container[_ngcontent-%COMP%]{position:relative;margin-bottom:20px}.input-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;display:block;text-align:left;margin-bottom:5px;font-weight:700;color:#fff;font-size:18px}.input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;width:100%;padding:20px 20px 20px 60px;border-radius:50px;background-color:#171c1c;border:none;color:#9395a4;font-size:18px;height:60px}input.input-style[_ngcontent-%COMP%]{background:none;border:none;padding:5px 0;margin:14px 0 4px;border-bottom:2px solid #e7e7e7;font-size:20px;width:360px;text-indent:1em}input.input-style[_ngcontent-%COMP%]:focus{outline:none;border-bottom:2px solid #ffffff;font-size:20px;width:360px;text-indent:1em;padding:5px 0;margin:14px 0 4px}.input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border:2px solid #000ceb}.input-circle[_ngcontent-%COMP%]{position:absolute;top:50%;left:15px;transform:translateY(-50%);background-color:#000e5a;border-radius:50%;width:40px;height:40px;display:flex;justify-content:center;align-items:center;color:#fff;font-size:18px}button[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-weight:600;width:100%;padding:20px;font-size:18px;background-color:#92d1f9;color:#000;border:none;border-radius:50px;cursor:pointer;margin-top:10px;transition:.2s ease-in-out}button[_ngcontent-%COMP%]:hover{background-color:#44b7ff}ul.list-btns[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}li.list-itens[_ngcontent-%COMP%]{list-style:none;padding:6px}ion-button.btn-s[_ngcontent-%COMP%]{--background: transparent;--color: red;--border: 1px solid red;--border-radius: 30px;--font-size: 16px;--font-weight: 600;--padding: 10px 30px;--box-shadow: none;transition:.7ms ease-in}ion-button.btn-s[_ngcontent-%COMP%]:hover{--background: rgb(107, 0, 0);--color: #ffffff}ion-checkbox[_ngcontent-%COMP%]{--size: 32px;--checkbox-background-checked: #44b7ff;font-size:20px}ion-checkbox[_ngcontent-%COMP%]::part(container){border-radius:6px;border:2px solid #000e5a}"]}),s})()}];let j=(()=>{var t;class s{}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[b.iI.forChild(U),b.iI]}),s})(),O=(()=>{var t;class s{}return(t=s).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[C.MD,a.YN,u.bv,j,a.X1]}),s})()}}]);